---
import { markdownify } from "@/lib/utils/textConverter";
import DashedSeparator from "../DashedSeparator.astro";
import ImageMod from "../ImageMod.astro";
import Counter from "../functional/Counter";
import type { CollectionEntry } from "astro:content";

type Props = {
  about: CollectionEntry<"ueber_uns">["data"]["about"];
};

const { about } = Astro.props;
---

<section class="section -mt-12 pt-0">
  <div class="container">
    <div
      class={`flex xl:flex-row flex-col xl:justify-between justify-center max-xl:gap-9 ${Astro.url.pathname.includes("ueber-uns") && "mb-24"}`}
    >
      <!-- Image -->
      <div
        class="w-full lg:w-4/5 xl:w-[43%] mx-auto"
        data-aos="fade-up-sm"
        data-aos-delay="200"
      >
        <ImageMod
          src={about.image}
          alt={about.title}
          width={490}
          height={559}
          class="object-cover mx-auto rounded-3xl w-full"
        />
      </div>

      <!-- Content -->
      <div class="w-full lg:w-4/5 xl:w-[49%] min-h-full mx-auto">
        <div class="flex flex-col justify-between h-full">
          <div>
            <h2
              set:html={markdownify(about.title)}
              class="mb-6 max-xl:text-center"
              data-aos="fade-up-sm"
            />
            <p
              set:html={markdownify(about.content)}
              class="max-xl:text-center"
              data-aos="fade-up-sm"
            />
          </div>


          <!-- Stats -->
          <div class="flex flex-row max-lg:flex-wrap justify-center xl:justify-between gap-4">
            {about.stats.map((stat, index) => (
              <div
                class="lg:w-1/3 max-xl:text-center"
                data-aos="fade-up-sm"
                data-aos-delay={index * 100}
              >
                <p set:html={markdownify(stat.title)} />
                <Counter
                  count={stat.value}
                  suffix={stat.suffix}
                  duration={2}
                  className="h1 text-text-dark font-semibold"
                  client:load
                />
              </div>
            ))}
          </div>
        </div>
      </div>
    </div>

    <!-- Trusted Partners -->
    {about.trusted && (
      <div class="mt-12">
        <h4
          set:html={markdownify(about.trusted.title)}
          class="text-center text-2xl mb-8 max-lg:[&>br]:hidden"
          data-aos="fade-up-sm"
          data-aos-delay="200"
        />
        <div
          class="swiper trusted-partners-slider"
          data-aos="fade-up-sm"
          data-aos-delay="300"
        >
          <div class="swiper-wrapper items-center">
            {about.trusted.partners.map((partner) => (
              <div class="swiper-slide">
                <div class="flex items-center justify-center h-24">
                  <ImageMod
                    src={partner}
                    alt={partner}
                    width={174}
                    height={75}
                    class="object-contain w-auto h-auto max-h-[75px] max-w-full grayscale hover:grayscale-0 transition-all duration-300"
                  />
                </div>
              </div>
            ))}
          </div>
        </div>
      </div>
    )}
  </div>
</section>

<script>
  import { Swiper } from "swiper";
  import "swiper/css";
  import { Autoplay } from "swiper/modules";

  document.addEventListener("astro:page-load", () => {
    const trustedPartnersSlider = document.querySelector(".trusted-partners-slider");
    if (trustedPartnersSlider) {
      new Swiper(".trusted-partners-slider", {
        modules: [Autoplay],
        slidesPerView: 2,
        spaceBetween: 30,
        loop: true,
        autoplay: {
          delay: 3000,
          disableOnInteraction: false,
          pauseOnMouseEnter: true,
        },
        breakpoints: {
          640: {
            slidesPerView: 3,
            spaceBetween: 40,
          },
          768: {
            slidesPerView: 4,
            spaceBetween: 50,
          },
          1024: {
            slidesPerView: 5,
            spaceBetween: 60,
          },
        },
      });
    }
  });
</script>
