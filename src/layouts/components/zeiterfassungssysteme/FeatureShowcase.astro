---
import IconMapper from "@/components/IconMapper.astro";

interface Props {
  features?: {
    title: string;
    description: string;
    icon?: string;
  }[];
}

const { features } = Astro.props;

// Features auf 3 Spalten verteilen
const leftColumn: typeof features = [];
const middleColumn: typeof features = [];
const rightColumn: typeof features = [];

features?.forEach((feature, i) => {
  const col = i % 3;
  if (col === 0) leftColumn.push(feature);
  else if (col === 1) middleColumn.push(feature);
  else rightColumn.push(feature);
});
---

{features && features.length > 0 && (
  <section class="section bg-primary" id="features">
    <div class="container">
      <div class="flex flex-wrap lg:flex-nowrap gap-6 justify-center w-full">
        <!-- Linke Spalte -->
        <div class="w-full lg:w-1/3 min-h-full flex flex-col md:flex-row lg:flex-col gap-6">
          {leftColumn.map((feature, i) => (
            <div
              class="rounded-2xl overflow-hidden flex flex-col"
              data-aos="zoom-in-sm"
              data-aos-delay={`${i * 100}`}
            >
              <div class="bg-light/15 grow relative grid place-items-center py-12">
                <div class="text-light/90">
                  <IconMapper icon={feature.icon || "check"} size="2.5rem" ariaHidden={true} />
                </div>
              </div>
              <div class="p-6 bg-light/10 mt-auto">
                <p class="text-xl mb-2 text-light">{feature.title}</p>
                <p class="text-light/70">{feature.description}</p>
              </div>
            </div>
          ))}
        </div>
        <!-- Mittlere Spalte -->
        <div class="w-full lg:w-1/3 min-h-full flex flex-col md:flex-row lg:flex-col gap-6">
          {middleColumn.map((feature) => (
            <div class="rounded-2xl overflow-hidden flex flex-col">
              <div class="bg-light/15 grow relative grid place-items-center py-12">
                <div class="text-light/90">
                  <IconMapper icon={feature.icon || "check"} size="2.5rem" ariaHidden={true} />
                </div>
              </div>
              <div class="p-6 bg-light/10 mt-auto">
                <p class="text-xl mb-2 text-light">{feature.title}</p>
                <p class="text-light/70">{feature.description}</p>
              </div>
            </div>
          ))}
        </div>
        <!-- Rechte Spalte -->
        <div class="w-full lg:w-1/3 min-h-full flex flex-col md:flex-row lg:flex-col gap-6">
          {rightColumn.map((feature, i) => (
            <div
              class="rounded-2xl overflow-hidden flex flex-col"
              data-aos="zoom-in-sm"
              data-aos-delay={`${i * 100}`}
            >
              <div class="bg-light/15 grow relative grid place-items-center py-12">
                <div class="text-light/90">
                  <IconMapper icon={feature.icon || "check"} size="2.5rem" ariaHidden={true} />
                </div>
              </div>
              <div class="p-6 bg-light/10 mt-auto">
                <p class="text-xl mb-2 text-light">{feature.title}</p>
                <p class="text-light/70">{feature.description}</p>
              </div>
            </div>
          ))}
        </div>
      </div>
    </div>
  </section>
)}
