document.addEventListener("astro:page-load",()=>{const h=document.getElementById("pricing-products-data");if(!h){console.error("Pricing products data element not found");return}let m;try{m=JSON.parse(h.textContent||"{}")}catch(o){console.error("Failed to parse pricing products data:",o);return}const x=document.querySelectorAll(".product-tab-btn"),w=document.querySelectorAll(".pricing-card-wrapper"),$={chip:{badge:"Preis-Leistungs-Sieger",color:"from-emerald-500 to-teal-600",bgColor:"bg-emerald-50",textColor:"text-emerald-600",title:"RFID Chip Zeiterfassung",shortDescription:"Schnell, hygienisch und kontaktlos. Jeder Mitarbeiter erhaelt einen persoenlichen Chip.",link:"/zeiterfassungssysteme/chip"},fingerabdruck:{badge:"Sicherheits-Sieger",color:"from-blue-500 to-indigo-600",bgColor:"bg-blue-50",textColor:"text-blue-600",title:"Fingerabdruck Zeiterfassung",shortDescription:"Biometrische Zeiterfassung mit hoechster Sicherheit und Manipulationssicherheit.",link:"/zeiterfassungssysteme/fingerabdruck"},gesichtserkennung:{badge:"Hygiene-Sieger",color:"from-purple-500 to-pink-600",bgColor:"bg-purple-50",textColor:"text-purple-600",title:"Gesichtserkennung Zeiterfassung",shortDescription:"KI-basierte Zeiterfassung - beruehrungslos, schnell und benutzerfreundlich.",link:"/zeiterfassungssysteme/gesichtserkennung"}},C={Starter:"10",Medium:"11",Pro:"30"};function p(o,t,n){const a=new URLSearchParams;return a.set("model",o),a.set("interest",n.toLowerCase().includes("bestellen")?"order":"offer"),a.set("employees",C[t]||"10"),`/kontakt?${a.toString()}`}function y(o){const t=$[o];if(!t)return;const n=document.getElementById("preview-badge");n&&(n.textContent=t.badge,n.className=`absolute top-3 right-3 px-3 py-1 rounded-full text-xs font-bold text-white bg-gradient-to-r ${t.color} z-10`);const a=document.getElementById("preview-bg");a&&(a.className=`${t.bgColor} p-4 flex items-center justify-center`),document.querySelectorAll(".preview-image").forEach(c=>{c.getAttribute("data-product")===o?c.classList.remove("hidden"):c.classList.add("hidden")}),document.querySelectorAll(".preview-badge-icon").forEach(c=>{c.getAttribute("data-product")===o?c.classList.remove("hidden"):c.classList.add("hidden")});const l=document.getElementById("preview-title");l&&(l.textContent=t.title);const e=document.getElementById("preview-description");e&&(e.textContent=t.shortDescription);const g=document.getElementById("preview-icon-badge");g&&(g.className=`w-10 h-10 rounded-xl ${t.bgColor} flex items-center justify-center`)}function k(o){let t=m[o];if(t||(t=m[o.toLowerCase()]),!t){console.error(`Product data not found for: ${o}`),console.log("Available keys:",Object.keys(m));return}if(!t.plans||!Array.isArray(t.plans)){console.error(`No plans found for product: ${o}`);return}const n=t.plans,a=Array.from(w);if(a.length===0){console.error("No pricing card wrappers found");return}if(n.length===0){console.error("No plans found");return}n.forEach((s,u)=>{if(a[u]){const l=a[u].querySelector(".rounded-2xl");if(!l)return;const e=s.badge==="BELIEBT"||u===1;a[u].setAttribute("data-product",o);const g=l.querySelector(".flex.flex-col.mb-8");if(g){if(g.querySelectorAll("span.inline-block.px-3").forEach(d=>d.remove()),(s.badge==="BELIEBT"||u===1&&!s.badge)&&u===1){const d=document.createElement("span");d.className=`inline-block px-3 py-1 rounded-full text-xs font-semibold mb-2 w-fit ${e?"bg-tertiary text-text-dark":"bg-primary/10 text-primary"}`,d.textContent="BELIEBT",g.insertBefore(d,g.firstChild)}else if(s.badge){const d=document.createElement("span");d.className=`inline-block px-3 py-1 rounded-full text-xs font-semibold mb-2 w-fit ${e?"bg-tertiary text-text-dark":"bg-primary/10 text-primary"}`,d.textContent=s.badge,g.insertBefore(d,g.firstChild)}}const c=l.querySelector("h4");c&&(c.textContent=s.title,c.className=`mb-1 text-2xl font-bold ${e?"text-light":"text-text-dark"}`);const b=l.querySelector(".mb-2.text-sm");b&&(b.textContent=s.description,b.className=`mb-2 text-sm ${e?"text-light/70":"text-text-dark/70"}`);const f=l.querySelector(".mt-4");if(f)if(s.price){let i=`
                <p class="text-[2.5rem] font-semibold mb-1 ${e?"text-light":"text-text-dark"}">ab ${s.price} €</p>
              `;s.discount_price&&(i+=`
                  <p class="text-sm font-medium ${e?"text-tertiary":"text-secondary"}">Sofort bestellen und 10% sparen: ${s.discount_price} €</p>
                `),i+=`
                <p class="text-sm mt-1 ${e?"text-light/70":"text-text-dark/70"}">${s.price_note}</p>
              `,f.innerHTML=i}else f.innerHTML=`
                <p class="text-xl font-semibold mb-1 ${e?"text-light":"text-text-dark"}">${s.price_custom}</p>
                <p class="text-sm ${e?"text-light/70":"text-text-dark/70"}">${s.price_note}</p>
              `;const v=l.querySelector("ul.space-y-3");v&&(v.innerHTML=s.features.map(i=>`
              <li class="flex items-start">
                <span class="p-1.5 rounded mr-2 mt-0.5 flex-shrink-0 ${e?"bg-light/20 border border-light/30":"bg-text/10 border border-border/20"}">
                  <svg class="w-4 h-4 ${e?"text-tertiary":"text-text-dark"}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                </span>
                <span class="text-sm ${e?"text-light":"text-text-dark"}">${i}</span>
              </li>
            `).join(""));const L=l.querySelector(".mt-auto.space-y-3");L&&s.buttons&&(L.innerHTML=s.buttons.map(i=>{if(i.style==="badge")return`
                    <div class="inline-block px-4 py-2 rounded-lg text-sm font-semibold w-full text-center ${e?"bg-tertiary text-text-dark":"bg-primary/10 text-primary"}">${i.label}</div>
                  `;if(i.style==="light"&&s.discount_price){const E=Number(s.price)-Number(s.discount_price);return`
                    <a href="${p(o,s.title,i.label)}" class="block w-full text-center rounded-lg border-2 transition-all ${e?"bg-light border-light hover:bg-light/90":"bg-white border-border hover:bg-tertiary"}">
                      <div class="py-3 px-4">
                        <span class="font-semibold text-text-dark">${i.label}</span>
                        <div class="text-xs mt-1 font-medium text-secondary">10% Rabatt - Sie sparen ${E} €</div>
                      </div>
                    </a>
                  `}let r="";return i.style==="light"?r=e?"bg-light text-text-dark hover:bg-light/90 border border-light":"bg-white text-text-dark hover:bg-tertiary border border-border":i.style==="primary"?r=e?"bg-tertiary text-text-dark hover:bg-tertiary/90":"btn-primary":i.style==="secondary"?r=e?"bg-secondary text-white hover:bg-secondary/90":"btn-secondary":r=e?"bg-light/20 text-light hover:bg-light/30 border-light/30":"btn-secondary",`
                  <a href="${p(o,s.title,i.label)}" class="btn w-full text-center ${r}">${i.label}</a>
                `}).join("")),l.className=`mx-auto rounded-2xl p-6 h-full flex flex-col ${e?"bg-primary":"bg-light"}`,l.querySelectorAll("p, span, li").forEach(i=>{const r=i;r.closest(".mt-auto")||r.classList.contains("inline-block")&&r.textContent?.includes("BELIEBT")||(e?(r.classList.contains("text-text-dark")&&(r.classList.remove("text-text-dark"),r.classList.add("text-light")),r.classList.contains("text-text-dark/70")&&(r.classList.remove("text-text-dark/70"),r.classList.add("text-light/70"))):(r.classList.contains("text-light")&&(r.classList.remove("text-light"),r.classList.add("text-text-dark")),r.classList.contains("text-light/70")&&(r.classList.remove("text-light/70"),r.classList.add("text-text-dark/70"))))}),l.querySelectorAll("li span.text-sm").forEach(i=>{const r=i;r.className=`text-sm ${e?"text-light":"text-text-dark"}`})}})}if(x.length===0){console.error("No tab buttons found");return}if(x.forEach(o=>{o.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation();const n=o.getAttribute("data-product");if(console.log("Tab clicked, product type:",n),!n){console.error("No product type found on button");return}x.forEach(a=>{a.classList.remove("bg-primary","text-white"),a.classList.add("bg-light","dark:bg-darkmode-light","text-text-dark","dark:text-darkmode-text-dark","hover:bg-primary/10")}),o.classList.remove("bg-light","dark:bg-darkmode-light","text-text-dark","dark:text-darkmode-text-dark","hover:bg-primary/10"),o.classList.add("bg-primary","text-white"),console.log("Calling updatePricingCards with:",n),k(n),y(n)})}),x.length>0){const t=x[0].getAttribute("data-product");console.log("Initializing with product type:",t),t&&(k(t),y(t))}});
